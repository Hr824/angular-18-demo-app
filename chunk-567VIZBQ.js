import{a as K,b as W,c as _,d as X,e as Y,f as C,h as ee,j as te,k as ie,l as ne,m as oe,n as re,o as se,p as ae,r as le}from"./chunk-B5S55IIR.js";import{a as H,b as J}from"./chunk-7GHFXXJX.js";import{f as Z}from"./chunk-ZZNQI2HT.js";import{Eb as l,Fb as O,Fd as z,Gb as f,Mb as j,Nb as P,Sa as m,Ta as N,Za as x,a as F,aa as I,dd as G,eb as q,fa as D,fb as k,ga as Q,gb as A,hb as M,jb as v,lb as h,ma as w,mb as R,nb as b,ob as y,od as U,pb as r,q as E,qb as a,rb as d,sb as L,ub as V,vb as p,wa as $,wb as B,xa as T,xb as c}from"./chunk-DH3RPQDP.js";import"./chunk-2NFLSA4Y.js";var me=(()=>{let n=class n{constructor(e){this.httpClient=e,this.QUESTION_API_URL="api/questions"}getAllQuestions(){return this.httpClient.get(this.QUESTION_API_URL)}getRandomInt(e,i){return Math.floor(Math.random()*(i-e+1))+e}getRandomQuestionIds(e,i,o){let u=[],g;for(let S=0;S<o;S++){for(g=this.getRandomInt(e,i);u.includes(g);)g=this.getRandomInt(e,i);u.push(g)}return u}};n.\u0275fac=function(i){return new(i||n)(D(Z))},n.\u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var _e=(t,n)=>n.id,xe=()=>[ee,oe,re,W,K,ne,X,Y,se,te,ie,G,U],ve=t=>({"max-width":t});function he(t,n){if(t&1&&(r(0,"fieldset",10)(1,"legend",15),l(2),r(3,"span",16),l(4,"*"),a()(),d(5,"div",17),r(6,"div",18)(7,"div",19),d(8,"input",20),r(9,"label",21),l(10),a()()()()),t&2){let s=p(),e=s.$implicit,i=s.$index;m(2),f("Question ",i+1," "),m(6),c("name","question",e.id,""),c("id","question",e.id,""),c("formControlName","question",e.id,""),m(),c("for","question",e.id,""),m(),f(" ",e.title," ")}}function Ce(t,n){t&1&&(r(0,"div",24),l(1," La r\xE9ponse est obligatoire "),a())}function ge(t,n){t&1&&(r(0,"div",24),l(1," Maximum 10 caract\xE8res "),a())}function qe(t,n){t&1&&(r(0,"div",24),l(1," Saisie incorrecte "),a())}function be(t,n){if(t&1&&(r(0,"div",10)(1,"div",22),l(2),r(3,"span",16),l(4,"*"),a()(),r(5,"div",23),l(6),r(7,"div"),q(8,Ce,2,0,"div",24)(9,ge,2,0,"div",24)(10,qe,2,0,"div",24),a()(),r(11,"div",25),d(12,"input",26),a()()),t&2){let s=p(),e=s.$implicit,i=s.$index,o=p(2);m(2),f(" Question ",i+1," "),m(4),f(" ",e.title," "),m(2),h(o.showErrorMessage("question"+e.id,"required")?8:-1),m(),h(o.showErrorMessage("question"+e.id,"maxlength")?9:-1),m(),h(o.showErrorMessage("question"+e.id,"pattern")?10:-1),m(2),c("id","question",e.id,""),c("formControlName","question",e.id,"")}}function ye(t,n){if(t&1&&(r(0,"option",28),l(1),a()),t&2){let s=n.$implicit;B("value",s),m(),O(s)}}function Se(t,n){if(t&1&&(r(0,"div",10)(1,"div",22),l(2),r(3,"span",16),l(4,"*"),a()(),r(5,"div",23),l(6),a(),r(7,"div",25)(8,"select",27),b(9,ye,2,2,"option",28,R),a()()()),t&2){let s=p(),e=s.$implicit,i=s.$index;m(2),f(" Question ",i+1," "),m(4),f(" ",e.title," "),m(2),c("id","question",e.id,""),c("name","question",e.id,""),c("formControlName","question",e.id,""),v("ngStyle",P(9,ve,e.id===26||e.id===29?"100px":"180px")),m(),y(e.answers)}}function Fe(t,n){}function Ee(t,n){if(t&1&&q(0,he,11,10,"fieldset",10)(1,be,13,9,"div",10)(2,Se,11,11,"div",10)(3,Fe,0,0),t&2){let s,e=n.$implicit;h((s=e.type)===1?0:s===2?1:s===3?2:3)}}function Ie(t,n){if(t&1){let s=L();r(0,"div",2)(1,"div",5)(2,"div",6)(3,"div",7),l(4,"Questionnaire"),a(),r(5,"div",8)(6,"form",9),V("ngSubmit",function(){$(s);let i=p();return T(i.onSubmit())}),b(7,Ee,4,1,null,null,_e),r(9,"div",10)(10,"div",11)(11,"button",12),l(12,"Valider"),a()(),d(13,"div",13),a()()()()(),d(14,"div",14),a()}if(t&2){let s=p();m(6),v("formGroup",s.questionnaireForm),m(),y(s.selectedQuestions()),m(4),v("disabled",s.questionnaireForm.invalid)("ngClass",s.questionnaireForm.invalid?"btn btn-outline-secondary btn-sm rounded-pill":"btn btn-outline-info btn-sm rounded-pill")}}function De(t,n){t&1&&d(0,"app-loader")}var ce="^([A-Za-z0-9\xE0\xE2\xE4\xE9\xE8\xEA\xEB\xEE\xEF\xF4\xF6\xF9\xFB\xFC\xE7\xC7\xC0\xC2\xC4\xC9\xC8\xCA\xCB\xCE\xCF\xD4\xD6\xD9\xDB\xDC]+[-]{0,1}[ ]{0,1}[A-Za-z0-9\xE0\xE2\xE4\xE9\xE8\xEA\xEB\xEE\xEF\xF4\xF6\xF9\xFB\xFC\xE7\xC7\xC0\xC2\xC4\xC9\xC8\xCA\xCB\xCE\xCF\xD4\xD6\xD9\xDB\xDC]*)$",de=1,ue=30,pe=5,Oe=(()=>{let n=class n{constructor(e){this.formBuilder=e,this.theme=x("Reactive Form"),this.page=x("Questionnaire dynamique"),this.questions=x([]),this.selectedQuestions=x([]),this.subscriptions=new F,this.questionService=Q(me),this.questionnaireForm=this.formBuilder.group({})}ngOnInit(){let e=this.getAllQuestions(),i=this.questionService.getRandomQuestionIds(de,ue,pe);this.subscriptions.add(e.pipe(E(o=>o.filter(u=>i.includes(u.id)))).subscribe({next:o=>{this.selectedQuestions.set(o);let u=this.getQuestionControl(this.selectedQuestions());this.questionnaireForm=this.formBuilder.group(u)}}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onSubmit(){if(this.questionnaireForm.valid){let e=this.questionService.getRandomQuestionIds(de,ue,pe);this.selectedQuestions.set(this.questions().filter(o=>e.includes(o.id)));let i=this.getQuestionControl(this.selectedQuestions());this.questionnaireForm=this.formBuilder.group(i)}}getAllQuestions(){let e=this.questionService.getAllQuestions();return this.subscriptions.add(e.subscribe({next:i=>{this.questions.set(i)}})),e}getQuestionControl(e){let i={};return e.forEach(o=>{switch(o.type){case 1:i[`question${o.id}`]=new C(!1,{nonNullable:!0});break;case 2:i[`question${o.id}`]=new C("",[_.required,_.maxLength(10),_.pattern(ce)]);break;case 3:i[`question${o.id}`]=new C(o.answers[0]);break;default:i[`question${o.id}`]=new C("",[_.required,_.maxLength(10),_.pattern(ce)]);break}}),i}showErrorMessage(e,i){let o=this.questionnaireForm.controls[e];return o.hasError(i)&&(o.touched||o.dirty)}};n.\u0275fac=function(i){return new(i||n)(N(ae))},n.\u0275cmp=w({type:n,selectors:[["app-dynamic-form"]],standalone:!0,features:[j],decls:16,vars:2,consts:[[1500],[3,"theme","page"],[1,"row"],[1,"col-12"],[1,"mg-page-title"],[1,"col-7"],[1,"card","border-info","mb-3"],[1,"card-header","text-center","fw-bold"],[1,"card-body","text-center"],["autocomplete","off",3,"ngSubmit","formGroup"],[1,"row","mb-3"],[1,"col-sm-3"],["type","submit",3,"disabled","ngClass"],[1,"col-sm-11"],[1,"col-5"],[1,"col-form-label","col-sm-2","pt-0"],[1,"text-danger"],[1,"col-sm-6"],[1,"col-sm-4","text-start"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"name","id","formControlName"],[1,"form-check-label",3,"for"],[1,"col-sm-2"],[1,"col-sm-6","text-start"],[1,"invalid-feedback","d-block"],[1,"col-sm-4"],["type","text","maxlength","10",1,"form-control",2,"max-width","180px",3,"id","formControlName"],[1,"form-select",3,"id","name","formControlName","ngStyle"],[3,"value"]],template:function(i,o){i&1&&(d(0,"app-breadcrumb",1),r(1,"div",2)(2,"div",3)(3,"div",4)(4,"h3"),l(5,"Reactive Form (Questionnaire dynamique)"),a(),r(6,"div"),l(7," - Pour l'exemple, ce formulaire affiche 5 questions al\xE9atoires s\xE9lectionn\xE9es parmi 30 questions "),a(),r(8,"div"),l(9," - Lorsque l'on valide le formulaire, 5 nouvelles questions sont propos\xE9es "),a(),r(10,"div"),l(11," - Il n'y a aucune r\xE8gle fonctionnelle d\xE9finie donc une question peut \xEAtre propos\xE9e plusieurs fois "),a()()()(),q(12,Ie,15,3)(13,De,1,0),A(14,12,xe,null,13,null,null,0,k),M()),i&2&&v("theme",o.theme())("page",o.page())},dependencies:[le,z,H,J]});let t=n;return t})();export{Oe as DynamicFormComponent};
