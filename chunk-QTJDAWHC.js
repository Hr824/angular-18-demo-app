import{b as K,c as W,e as f,f as X,g as Y,i as v,k as ee,m as te,n as ie,o as ne,p as oe,q as re,s as se,u as ae,w as le}from"./chunk-K53NGABD.js";import{a as U,b as J}from"./chunk-IJBBQY3R.js";import{a as H}from"./chunk-6WDZCA3R.js";import{f as Z}from"./chunk-3GBJEJSQ.js";import{$a as g,Ab as R,Ad as G,Bb as u,Eb as L,Fb as c,Nb as s,Ob as B,Pb as p,Rd as z,Ta as a,Ua as N,Vb as O,Xb as j,a as S,ca as E,gb as C,ha as I,ia as D,kb as T,lb as k,mb as A,oa as Q,ob as _,pd as P,q as F,qb as x,sb as M,tb as y,ub as b,vb as o,wb as r,xb as d,ya as w,yb as V,za as $}from"./chunk-6YNXGWAZ.js";import"./chunk-2NFLSA4Y.js";var me=(()=>{class i{constructor(t){this.httpClient=t}getAllQuestions(){return this.httpClient.get(H.API_END_POINTS.QUESTIONS)}getRandomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}getRandomQuestionIds(t,e,n){let m=[],h;for(let q=0;q<n;q++){for(h=this.getRandomInt(t,e);m.includes(h);)h=this.getRandomInt(t,e);m.push(h)}return m}static{this.\u0275fac=function(e){return new(e||i)(I(Z))}}static{this.\u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var _e=(i,l)=>l.id,xe=()=>[ee,oe,re,W,K,ne,X,Y,se,te,ie,P,G],ve=i=>({"max-width":i});function he(i,l){if(i&1&&(o(0,"fieldset",10)(1,"legend",15),s(2),o(3,"span",16),s(4,"*"),r()(),d(5,"div",17),o(6,"div",18)(7,"div",19),d(8,"input",20),o(9,"label",21),s(10),r()()()()),i&2){let t=u(),e=t.$implicit,n=t.$index;a(2),p("Question ",n+1," "),a(6),c("name","question",e.id,""),c("id","question",e.id,""),c("formControlName","question",e.id,""),a(),c("for","question",e.id,""),a(),p(" ",e.title," ")}}function Ce(i,l){i&1&&(o(0,"div",24),s(1," La r\xE9ponse est obligatoire "),r())}function ge(i,l){i&1&&(o(0,"div",24),s(1," Maximum 10 caract\xE8res "),r())}function ye(i,l){i&1&&(o(0,"div",24),s(1," Saisie incorrecte "),r())}function be(i,l){if(i&1&&(o(0,"div",10)(1,"div",22),s(2),o(3,"span",16),s(4,"*"),r()(),o(5,"div",23),s(6),o(7,"div"),C(8,Ce,2,0,"div",24)(9,ge,2,0,"div",24)(10,ye,2,0,"div",24),r()(),o(11,"div",25),d(12,"input",26),r()()),i&2){let t=u(),e=t.$implicit,n=t.$index,m=u(2);a(2),p(" Question ",n+1," "),a(4),p(" ",e.title," "),a(2),x(m.showErrorMessage("question"+e.id,"required")?8:-1),a(),x(m.showErrorMessage("question"+e.id,"maxlength")?9:-1),a(),x(m.showErrorMessage("question"+e.id,"pattern")?10:-1),a(2),c("id","question",e.id,""),c("formControlName","question",e.id,"")}}function qe(i,l){if(i&1&&(o(0,"option",28),s(1),r()),i&2){let t=l.$implicit;L("value",t),a(),B(t)}}function Se(i,l){if(i&1&&(o(0,"div",10)(1,"div",22),s(2),o(3,"span",16),s(4,"*"),r()(),o(5,"div",23),s(6),r(),o(7,"div",25)(8,"select",27),y(9,qe,2,2,"option",28,M),r()()()),i&2){let t=u(),e=t.$implicit,n=t.$index;a(2),p(" Question ",n+1," "),a(4),p(" ",e.title," "),a(2),c("id","question",e.id,""),c("name","question",e.id,""),c("formControlName","question",e.id,""),_("ngStyle",j(9,ve,e.id===26||e.id===29?"100px":"180px")),a(),b(e.answers)}}function Fe(i,l){}function Ee(i,l){if(i&1&&C(0,he,11,10,"fieldset",10)(1,be,13,9,"div",10)(2,Se,11,11,"div",10)(3,Fe,0,0),i&2){let t,e=l.$implicit;x((t=e.type)===1?0:t===2?1:t===3?2:3)}}function Ie(i,l){if(i&1){let t=V();o(0,"div",2)(1,"div",5)(2,"div",6)(3,"div",7),s(4,"Questionnaire"),r(),o(5,"div",8)(6,"form",9),R("ngSubmit",function(){w(t);let n=u();return $(n.onSubmit())}),y(7,Ee,4,1,null,null,_e),o(9,"div",10)(10,"div",11)(11,"button",12),s(12,"Valider"),r()(),d(13,"div",13),r()()()()(),d(14,"div",14),r()}if(i&2){let t=u();a(6),_("formGroup",t.questionnaireForm),a(),b(t.selectedQuestions()),a(4),_("disabled",t.questionnaireForm.invalid)("ngClass",t.questionnaireForm.invalid?"btn btn-outline-secondary btn-sm rounded-pill":"btn btn-outline-info btn-sm rounded-pill")}}function De(i,l){i&1&&d(0,"app-loader")}var ce="^([A-Za-z0-9\xE0\xE2\xE4\xE9\xE8\xEA\xEB\xEE\xEF\xF4\xF6\xF9\xFB\xFC\xE7\xC7\xC0\xC2\xC4\xC9\xC8\xCA\xCB\xCE\xCF\xD4\xD6\xD9\xDB\xDC]+[-]{0,1}[ ]{0,1}[A-Za-z0-9\xE0\xE2\xE4\xE9\xE8\xEA\xEB\xEE\xEF\xF4\xF6\xF9\xFB\xFC\xE7\xC7\xC0\xC2\xC4\xC9\xC8\xCA\xCB\xCE\xCF\xD4\xD6\xD9\xDB\xDC]*)$",de=1,ue=30,pe=5,je=(()=>{class i{constructor(t){this.formBuilder=t,this.theme="Reactive Form",this.page="Questionnaire dynamique",this.questions=g([]),this.selectedQuestions=g([]),this.subscriptions=new S,this.questionService=D(me),this.questionnaireForm=this.formBuilder.group({})}ngOnInit(){let t=this.getAllQuestions(),e=this.questionService.getRandomQuestionIds(de,ue,pe);this.subscriptions.add(t.pipe(F(n=>n.filter(m=>e.includes(m.id)))).subscribe({next:n=>{this.selectedQuestions.set(n);let m=this.getQuestionControl(this.selectedQuestions());this.questionnaireForm=this.formBuilder.group(m)}}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onSubmit(){if(this.questionnaireForm.valid){let t=this.questionService.getRandomQuestionIds(de,ue,pe);this.selectedQuestions.set(this.questions().filter(n=>t.includes(n.id)));let e=this.getQuestionControl(this.selectedQuestions());this.questionnaireForm=this.formBuilder.group(e)}}getAllQuestions(){let t=this.questionService.getAllQuestions();return this.subscriptions.add(t.subscribe({next:e=>{this.questions.set(e)}})),t}getQuestionControl(t){let e={};return t.forEach(n=>{switch(n.type){case 1:e[`question${n.id}`]=new v(!1,{nonNullable:!0});break;case 2:e[`question${n.id}`]=new v("",[f.required,f.maxLength(10),f.pattern(ce)]);break;case 3:e[`question${n.id}`]=new v(n.answers[0]);break;default:e[`question${n.id}`]=new v("",[f.required,f.maxLength(10),f.pattern(ce)]);break}}),e}showErrorMessage(t,e){let n=this.questionnaireForm.controls[t];return n.hasError(e)&&(n.touched||n.dirty)}static{this.\u0275fac=function(e){return new(e||i)(N(ae))}}static{this.\u0275cmp=Q({type:i,selectors:[["app-dynamic-form"]],standalone:!0,features:[O],decls:16,vars:2,consts:[[1500],[3,"theme","page"],[1,"row"],[1,"col-12"],[1,"mg-page-title"],[1,"col-7"],[1,"card","border-info","mb-3"],[1,"card-header","text-center","fw-bold"],[1,"card-body","text-center"],["autocomplete","off",3,"ngSubmit","formGroup"],[1,"row","mb-3"],[1,"col-sm-3"],["type","submit",3,"disabled","ngClass"],[1,"col-sm-11"],[1,"col-5"],[1,"col-form-label","col-sm-2","pt-0"],[1,"text-danger"],[1,"col-sm-6"],[1,"col-sm-4","text-start"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"name","id","formControlName"],[1,"form-check-label",3,"for"],[1,"col-sm-2"],[1,"col-sm-6","text-start"],[1,"invalid-feedback","d-block"],[1,"col-sm-4"],["type","text","maxlength","10",1,"form-control",2,"max-width","180px",3,"id","formControlName"],[1,"form-select",3,"id","name","formControlName","ngStyle"],[3,"value"]],template:function(e,n){e&1&&(d(0,"app-breadcrumb",1),o(1,"div",2)(2,"div",3)(3,"div",4)(4,"h3"),s(5,"Reactive Form (Questionnaire dynamique)"),r(),o(6,"div"),s(7," - Pour l'exemple, ce formulaire affiche 5 questions al\xE9atoires s\xE9lectionn\xE9es parmi 30 questions "),r(),o(8,"div"),s(9," - Lorsque l'on valide le formulaire, 5 nouvelles questions sont propos\xE9es "),r(),o(10,"div"),s(11," - Il n'y a aucune r\xE8gle fonctionnelle d\xE9finie donc une question peut \xEAtre propos\xE9e plusieurs fois "),r()()()(),C(12,Ie,15,3)(13,De,1,0),k(14,12,xe,null,13,null,null,0,T),A()),e&2&&_("theme",n.theme)("page",n.page)},dependencies:[le,z,U,J]})}}return i})();export{je as DynamicFormComponent};
