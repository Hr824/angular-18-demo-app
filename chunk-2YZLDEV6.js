import{e as me}from"./chunk-FOSCC2JS.js";import{a as K,b as W,c as _,d as X,e as Y,f as C,h as ee,j as te,k as ie,l as ne,m as oe,n as re,o as se,p as ae,r as le}from"./chunk-43MB7BL2.js";import{a as U,b as J}from"./chunk-GF7T5KLA.js";import"./chunk-J3T55C4R.js";import{f as H}from"./chunk-NU7VILO4.js";import{Bb as L,Cb as p,Db as B,Eb as c,Mb as l,Nb as O,Nd as Z,Ob as f,Ub as j,Va as m,Vb as G,Wa as N,a as F,bb as x,ca as I,ha as D,ia as Q,ib as b,ld as P,mb as k,nb as M,oa as w,ob as A,q as E,qb as v,sb as h,tb as V,ub as q,vb as y,wb as r,wd as z,xb as a,ya as $,yb as d,za as T,zb as R}from"./chunk-LS5FHDU7.js";import"./chunk-2NFLSA4Y.js";var ce=(()=>{let n=class n{constructor(e){this.httpClient=e}getAllQuestions(){return this.httpClient.get(me.QUESTIONS)}getRandomInt(e,i){return Math.floor(Math.random()*(i-e+1))+e}getRandomQuestionIds(e,i,o){let u=[],g;for(let S=0;S<o;S++){for(g=this.getRandomInt(e,i);u.includes(g);)g=this.getRandomInt(e,i);u.push(g)}return u}};n.\u0275fac=function(i){return new(i||n)(D(H))},n.\u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();var xe=(t,n)=>n.id,ve=()=>[ee,oe,re,W,K,ne,X,Y,se,te,ie,P,z],he=t=>({"max-width":t});function Ce(t,n){if(t&1&&(r(0,"fieldset",10)(1,"legend",15),l(2),r(3,"span",16),l(4,"*"),a()(),d(5,"div",17),r(6,"div",18)(7,"div",19),d(8,"input",20),r(9,"label",21),l(10),a()()()()),t&2){let s=p(),e=s.$implicit,i=s.$index;m(2),f("Question ",i+1," "),m(6),c("name","question",e.id,""),c("id","question",e.id,""),c("formControlName","question",e.id,""),m(),c("for","question",e.id,""),m(),f(" ",e.title," ")}}function ge(t,n){t&1&&(r(0,"div",24),l(1," La r\xE9ponse est obligatoire "),a())}function be(t,n){t&1&&(r(0,"div",24),l(1," Maximum 10 caract\xE8res "),a())}function qe(t,n){t&1&&(r(0,"div",24),l(1," Saisie incorrecte "),a())}function ye(t,n){if(t&1&&(r(0,"div",10)(1,"div",22),l(2),r(3,"span",16),l(4,"*"),a()(),r(5,"div",23),l(6),r(7,"div"),b(8,ge,2,0,"div",24)(9,be,2,0,"div",24)(10,qe,2,0,"div",24),a()(),r(11,"div",25),d(12,"input",26),a()()),t&2){let s=p(),e=s.$implicit,i=s.$index,o=p(2);m(2),f(" Question ",i+1," "),m(4),f(" ",e.title," "),m(2),h(o.showErrorMessage("question"+e.id,"required")?8:-1),m(),h(o.showErrorMessage("question"+e.id,"maxlength")?9:-1),m(),h(o.showErrorMessage("question"+e.id,"pattern")?10:-1),m(2),c("id","question",e.id,""),c("formControlName","question",e.id,"")}}function Se(t,n){if(t&1&&(r(0,"option",28),l(1),a()),t&2){let s=n.$implicit;B("value",s),m(),O(s)}}function Fe(t,n){if(t&1&&(r(0,"div",10)(1,"div",22),l(2),r(3,"span",16),l(4,"*"),a()(),r(5,"div",23),l(6),a(),r(7,"div",25)(8,"select",27),q(9,Se,2,2,"option",28,V),a()()()),t&2){let s=p(),e=s.$implicit,i=s.$index;m(2),f(" Question ",i+1," "),m(4),f(" ",e.title," "),m(2),c("id","question",e.id,""),c("name","question",e.id,""),c("formControlName","question",e.id,""),v("ngStyle",G(9,he,e.id===26||e.id===29?"100px":"180px")),m(),y(e.answers)}}function Ee(t,n){}function Ie(t,n){if(t&1&&b(0,Ce,11,10,"fieldset",10)(1,ye,13,9,"div",10)(2,Fe,11,11,"div",10)(3,Ee,0,0),t&2){let s,e=n.$implicit;h((s=e.type)===1?0:s===2?1:s===3?2:3)}}function De(t,n){if(t&1){let s=R();r(0,"div",2)(1,"div",5)(2,"div",6)(3,"div",7),l(4,"Questionnaire"),a(),r(5,"div",8)(6,"form",9),L("ngSubmit",function(){$(s);let i=p();return T(i.onSubmit())}),q(7,Ie,4,1,null,null,xe),r(9,"div",10)(10,"div",11)(11,"button",12),l(12,"Valider"),a()(),d(13,"div",13),a()()()()(),d(14,"div",14),a()}if(t&2){let s=p();m(6),v("formGroup",s.questionnaireForm),m(),y(s.selectedQuestions()),m(4),v("disabled",s.questionnaireForm.invalid)("ngClass",s.questionnaireForm.invalid?"btn btn-outline-secondary btn-sm rounded-pill":"btn btn-outline-info btn-sm rounded-pill")}}function Qe(t,n){t&1&&d(0,"app-loader")}var de="^([A-Za-z0-9\xE0\xE2\xE4\xE9\xE8\xEA\xEB\xEE\xEF\xF4\xF6\xF9\xFB\xFC\xE7\xC7\xC0\xC2\xC4\xC9\xC8\xCA\xCB\xCE\xCF\xD4\xD6\xD9\xDB\xDC]+[-]{0,1}[ ]{0,1}[A-Za-z0-9\xE0\xE2\xE4\xE9\xE8\xEA\xEB\xEE\xEF\xF4\xF6\xF9\xFB\xFC\xE7\xC7\xC0\xC2\xC4\xC9\xC8\xCA\xCB\xCE\xCF\xD4\xD6\xD9\xDB\xDC]*)$",ue=1,pe=30,fe=5,Ge=(()=>{let n=class n{constructor(e){this.formBuilder=e,this.theme=x("Reactive Form"),this.page=x("Questionnaire dynamique"),this.questions=x([]),this.selectedQuestions=x([]),this.subscriptions=new F,this.questionService=Q(ce),this.questionnaireForm=this.formBuilder.group({})}ngOnInit(){let e=this.getAllQuestions(),i=this.questionService.getRandomQuestionIds(ue,pe,fe);this.subscriptions.add(e.pipe(E(o=>o.filter(u=>i.includes(u.id)))).subscribe({next:o=>{this.selectedQuestions.set(o);let u=this.getQuestionControl(this.selectedQuestions());this.questionnaireForm=this.formBuilder.group(u)}}))}ngOnDestroy(){this.subscriptions.unsubscribe()}onSubmit(){if(this.questionnaireForm.valid){let e=this.questionService.getRandomQuestionIds(ue,pe,fe);this.selectedQuestions.set(this.questions().filter(o=>e.includes(o.id)));let i=this.getQuestionControl(this.selectedQuestions());this.questionnaireForm=this.formBuilder.group(i)}}getAllQuestions(){let e=this.questionService.getAllQuestions();return this.subscriptions.add(e.subscribe({next:i=>{this.questions.set(i)}})),e}getQuestionControl(e){let i={};return e.forEach(o=>{switch(o.type){case 1:i[`question${o.id}`]=new C(!1,{nonNullable:!0});break;case 2:i[`question${o.id}`]=new C("",[_.required,_.maxLength(10),_.pattern(de)]);break;case 3:i[`question${o.id}`]=new C(o.answers[0]);break;default:i[`question${o.id}`]=new C("",[_.required,_.maxLength(10),_.pattern(de)]);break}}),i}showErrorMessage(e,i){let o=this.questionnaireForm.controls[e];return o.hasError(i)&&(o.touched||o.dirty)}};n.\u0275fac=function(i){return new(i||n)(N(ae))},n.\u0275cmp=w({type:n,selectors:[["app-dynamic-form"]],standalone:!0,features:[j],decls:16,vars:2,consts:[[1500],[3,"theme","page"],[1,"row"],[1,"col-12"],[1,"mg-page-title"],[1,"col-7"],[1,"card","border-info","mb-3"],[1,"card-header","text-center","fw-bold"],[1,"card-body","text-center"],["autocomplete","off",3,"ngSubmit","formGroup"],[1,"row","mb-3"],[1,"col-sm-3"],["type","submit",3,"disabled","ngClass"],[1,"col-sm-11"],[1,"col-5"],[1,"col-form-label","col-sm-2","pt-0"],[1,"text-danger"],[1,"col-sm-6"],[1,"col-sm-4","text-start"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"name","id","formControlName"],[1,"form-check-label",3,"for"],[1,"col-sm-2"],[1,"col-sm-6","text-start"],[1,"invalid-feedback","d-block"],[1,"col-sm-4"],["type","text","maxlength","10",1,"form-control",2,"max-width","180px",3,"id","formControlName"],[1,"form-select",3,"id","name","formControlName","ngStyle"],[3,"value"]],template:function(i,o){i&1&&(d(0,"app-breadcrumb",1),r(1,"div",2)(2,"div",3)(3,"div",4)(4,"h3"),l(5,"Reactive Form (Questionnaire dynamique)"),a(),r(6,"div"),l(7," - Pour l'exemple, ce formulaire affiche 5 questions al\xE9atoires s\xE9lectionn\xE9es parmi 30 questions "),a(),r(8,"div"),l(9," - Lorsque l'on valide le formulaire, 5 nouvelles questions sont propos\xE9es "),a(),r(10,"div"),l(11," - Il n'y a aucune r\xE8gle fonctionnelle d\xE9finie donc une question peut \xEAtre propos\xE9e plusieurs fois "),a()()()(),b(12,De,15,3)(13,Qe,1,0),M(14,12,ve,null,13,null,null,0,k),A()),i&2&&v("theme",o.theme())("page",o.page())},dependencies:[le,Z,U,J]});let t=n;return t})();export{Ge as DynamicFormComponent};
